<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../jacoco-resources/report.gif" type="image/gif"/><title>IteratorUtilsTest.java</title><link rel="stylesheet" href="../../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">commons-collections-collections-4.0 (25-Jun-2019 5:27:32 PM)</a> &gt; <a href="../../index.html" class="el_group">commons-collections-collections-4.0</a> &gt; <a href="../index.html" class="el_bundle">src/test/java</a> &gt; <a href="index.source.html" class="el_package">org.apache.commons.collections4</a> &gt; <span class="el_source">IteratorUtilsTest.java</span></div><h1>IteratorUtilsTest.java</h1><pre class="source lang-java linenums"><span class="fc" id="L1">/*</span>
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the &quot;License&quot;); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.apache.commons.collections4;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Iterator;
import java.util.List;
import java.util.ListIterator;
import java.util.NoSuchElementException;

import junit.framework.Test;

import org.apache.commons.collections4.iterators.EmptyIterator;
import org.apache.commons.collections4.iterators.EmptyListIterator;
import org.apache.commons.collections4.iterators.EmptyMapIterator;
import org.apache.commons.collections4.iterators.EmptyOrderedIterator;
import org.apache.commons.collections4.iterators.EmptyOrderedMapIterator;
import org.w3c.dom.Node;
import org.w3c.dom.NodeList;

import static org.easymock.EasyMock.createMock;
import static org.easymock.EasyMock.expect;
import static org.easymock.EasyMock.replay;

/**
 * Tests for IteratorUtils.
 *
 * @version $Id$
 */
public class IteratorUtilsTest extends BulkTest {

    public IteratorUtilsTest(final String name) {
<span class="fc" id="L48">        super(name);</span>
<span class="fc" id="L49">    }</span>

    public static Test suite() {
<span class="fc" id="L52">        return BulkTest.makeSuite(IteratorUtilsTest.class);</span>
    }

    public void testAsIterable() {
<span class="fc" id="L56">        final List&lt;Integer&gt; list = new ArrayList&lt;Integer&gt;();</span>
<span class="fc" id="L57">        list.add(Integer.valueOf(0));</span>
<span class="fc" id="L58">        list.add(Integer.valueOf(1));</span>
<span class="fc" id="L59">        list.add(Integer.valueOf(2));</span>
<span class="fc" id="L60">        final Iterator&lt;Integer&gt; iterator = list.iterator();</span>

<span class="fc" id="L62">        final Iterable&lt;Integer&gt; iterable = IteratorUtils.asIterable(iterator);</span>
<span class="fc" id="L63">        int expected = 0;</span>
<span class="fc bfc" id="L64" title="All 2 branches covered.">        for(final Integer actual : iterable) {</span>
<span class="fc" id="L65">            assertEquals(expected, actual.intValue());</span>
<span class="fc" id="L66">            ++expected;</span>
        }
        // insure iteration occurred
<span class="pc bpc" id="L69" title="1 of 2 branches missed.">        assertTrue(expected &gt; 0);</span>

        // single use iterator
<span class="fc" id="L72">        assertFalse(&quot;should not be able to iterate twice&quot;, IteratorUtils.asIterable(iterator).iterator().hasNext());</span>
<span class="fc" id="L73">    }</span>

    public void testAsIterableNull() {
        try {
<span class="nc" id="L77">            IteratorUtils.asIterable(null);</span>
<span class="nc" id="L78">            fail(&quot;Expecting NullPointerException&quot;);</span>
<span class="pc" id="L79">        } catch (final NullPointerException ex) {</span>
            // success
        }
<span class="fc" id="L82">    }</span>

    public void testAsMultipleIterable() {
<span class="fc" id="L85">        final List&lt;Integer&gt; list = new ArrayList&lt;Integer&gt;();</span>
<span class="fc" id="L86">        list.add(Integer.valueOf(0));</span>
<span class="fc" id="L87">        list.add(Integer.valueOf(1));</span>
<span class="fc" id="L88">        list.add(Integer.valueOf(2));</span>
<span class="fc" id="L89">        final Iterator&lt;Integer&gt; iterator = list.iterator();</span>

<span class="fc" id="L91">        final Iterable&lt;Integer&gt; iterable = IteratorUtils.asMultipleUseIterable(iterator);</span>
<span class="fc" id="L92">        int expected = 0;</span>
<span class="fc bfc" id="L93" title="All 2 branches covered.">        for(final Integer actual : iterable) {</span>
<span class="fc" id="L94">            assertEquals(expected, actual.intValue());</span>
<span class="fc" id="L95">            ++expected;</span>
        }
        // insure iteration occurred
<span class="pc bpc" id="L98" title="1 of 2 branches missed.">        assertTrue(expected &gt; 0);</span>

        // multiple use iterator
<span class="fc" id="L101">        expected = 0;</span>
<span class="fc bfc" id="L102" title="All 2 branches covered.">        for(final Integer actual : iterable) {</span>
<span class="fc" id="L103">            assertEquals(expected, actual.intValue());</span>
<span class="fc" id="L104">            ++expected;</span>
        }
        // insure iteration occurred
<span class="pc bpc" id="L107" title="1 of 2 branches missed.">        assertTrue(expected &gt; 0);</span>
<span class="fc" id="L108">    }</span>

    public void testAsMultipleIterableNull() {
        try {
<span class="nc" id="L112">            IteratorUtils.asMultipleUseIterable(null);</span>
<span class="nc" id="L113">            fail(&quot;Expecting NullPointerException&quot;);</span>
<span class="pc" id="L114">        } catch (final NullPointerException ex) {</span>
            // success
        }
<span class="fc" id="L117">    }</span>

    public void testToList() {
<span class="fc" id="L120">        final List&lt;Object&gt; list = new ArrayList&lt;Object&gt;();</span>
<span class="fc" id="L121">        list.add(Integer.valueOf(1));</span>
<span class="fc" id="L122">        list.add(&quot;Two&quot;);</span>
<span class="fc" id="L123">        list.add(null);</span>
<span class="fc" id="L124">        final List&lt;Object&gt; result = IteratorUtils.toList(list.iterator());</span>
<span class="fc" id="L125">        assertEquals(list, result);</span>
<span class="fc" id="L126">    }</span>

    public void testToArray() {
<span class="fc" id="L129">        final List&lt;Object&gt; list = new ArrayList&lt;Object&gt;();</span>
<span class="fc" id="L130">        list.add(Integer.valueOf(1));</span>
<span class="fc" id="L131">        list.add(&quot;Two&quot;);</span>
<span class="fc" id="L132">        list.add(null);</span>
<span class="fc" id="L133">        final Object[] result = IteratorUtils.toArray(list.iterator());</span>
<span class="fc" id="L134">        assertEquals(list, Arrays.asList(result));</span>
<span class="fc" id="L135">    }</span>

    public void testToArray2() {
<span class="fc" id="L138">        final List&lt;String&gt; list = new ArrayList&lt;String&gt;();</span>
<span class="fc" id="L139">        list.add(&quot;One&quot;);</span>
<span class="fc" id="L140">        list.add(&quot;Two&quot;);</span>
<span class="fc" id="L141">        list.add(null);</span>
<span class="fc" id="L142">        final String[] result = IteratorUtils.toArray(list.iterator(), String.class);</span>
<span class="fc" id="L143">        assertEquals(list, Arrays.asList(result));</span>
<span class="fc" id="L144">    }</span>

    public void testArrayIterator() {
<span class="fc" id="L147">        final Object[] objArray = {&quot;a&quot;, &quot;b&quot;, &quot;c&quot;};</span>
<span class="fc" id="L148">        ResettableIterator&lt;Object&gt; iterator = IteratorUtils.arrayIterator(objArray);</span>
<span class="fc" id="L149">        assertTrue(iterator.next().equals(&quot;a&quot;));</span>
<span class="fc" id="L150">        assertTrue(iterator.next().equals(&quot;b&quot;));</span>
<span class="fc" id="L151">        iterator.reset();</span>
<span class="fc" id="L152">        assertTrue(iterator.next().equals(&quot;a&quot;));</span>

        try {
<span class="nc" id="L155">            iterator = IteratorUtils.arrayIterator(Integer.valueOf(0));</span>
<span class="nc" id="L156">            fail(&quot;Expecting IllegalArgumentException&quot;);</span>
<span class="pc" id="L157">        } catch (final IllegalArgumentException ex) {</span>
                // expected
        }

        try {
<span class="nc" id="L162">            iterator = IteratorUtils.arrayIterator((Object[]) null);</span>
<span class="nc" id="L163">            fail(&quot;Expecting NullPointerException&quot;);</span>
<span class="pc" id="L164">        } catch (final NullPointerException ex) {</span>
                // expected
        }

<span class="fc" id="L168">        iterator = IteratorUtils.arrayIterator(objArray, 1);</span>
<span class="fc" id="L169">        assertTrue(iterator.next().equals(&quot;b&quot;));</span>

        try {
<span class="nc" id="L172">            iterator = IteratorUtils.arrayIterator(objArray, -1);</span>
<span class="nc" id="L173">            fail(&quot;Expecting IndexOutOfBoundsException&quot;);</span>
<span class="pc" id="L174">        } catch (final IndexOutOfBoundsException ex) {</span>
            // expected
        }

<span class="fc" id="L178">        iterator = IteratorUtils.arrayIterator(objArray, 3);</span>
<span class="pc bpc" id="L179" title="1 of 2 branches missed.">        assertTrue(!iterator.hasNext());</span>
<span class="fc" id="L180">        iterator.reset();</span>

        try {
<span class="nc" id="L183">            iterator = IteratorUtils.arrayIterator(objArray, 4);</span>
<span class="nc" id="L184">            fail(&quot;Expecting IndexOutOfBoundsException&quot;);</span>
<span class="pc" id="L185">        } catch (final IndexOutOfBoundsException ex) {</span>
            // expected
        }

<span class="fc" id="L189">        iterator = IteratorUtils.arrayIterator(objArray, 2, 3);</span>
<span class="fc" id="L190">        assertTrue(iterator.next().equals(&quot;c&quot;));</span>

        try {
<span class="nc" id="L193">            iterator = IteratorUtils.arrayIterator(objArray, 2, 4);</span>
<span class="nc" id="L194">            fail(&quot;Expecting IndexOutOfBoundsException&quot;);</span>
<span class="pc" id="L195">        } catch (final IndexOutOfBoundsException ex) {</span>
            // expected
        }

        try {
<span class="nc" id="L200">            iterator = IteratorUtils.arrayIterator(objArray, -1, 1);</span>
<span class="nc" id="L201">            fail(&quot;Expecting IndexOutOfBoundsException&quot;);</span>
<span class="pc" id="L202">        } catch (final IndexOutOfBoundsException ex) {</span>
            // expected
        }

        try {
<span class="nc" id="L207">            iterator = IteratorUtils.arrayIterator(objArray, 2, 1);</span>
<span class="nc" id="L208">            fail(&quot;Expecting IllegalArgumentException&quot;);</span>
<span class="pc" id="L209">        } catch (final IllegalArgumentException ex) {</span>
            // expected
        }

<span class="fc" id="L213">        final int[] intArray = {0, 1, 2};</span>
<span class="fc" id="L214">        iterator = IteratorUtils.arrayIterator(intArray);</span>
<span class="fc" id="L215">        assertTrue(iterator.next().equals(Integer.valueOf(0)));</span>
<span class="fc" id="L216">        assertTrue(iterator.next().equals(Integer.valueOf(1)));</span>
<span class="fc" id="L217">        iterator.reset();</span>
<span class="fc" id="L218">        assertTrue(iterator.next().equals(Integer.valueOf(0)));</span>

<span class="fc" id="L220">        iterator = IteratorUtils.arrayIterator(intArray, 1);</span>
<span class="fc" id="L221">        assertTrue(iterator.next().equals(Integer.valueOf(1)));</span>

        try {
<span class="nc" id="L224">            iterator = IteratorUtils.arrayIterator(intArray, -1);</span>
<span class="nc" id="L225">            fail(&quot;Expecting IndexOutOfBoundsException&quot;);</span>
<span class="pc" id="L226">        } catch (final IndexOutOfBoundsException ex) {</span>
            // expected
        }

<span class="fc" id="L230">        iterator = IteratorUtils.arrayIterator(intArray, 3);</span>
<span class="pc bpc" id="L231" title="1 of 2 branches missed.">        assertTrue(!iterator.hasNext());</span>
<span class="fc" id="L232">        iterator.reset();</span>

        try {
<span class="nc" id="L235">            iterator = IteratorUtils.arrayIterator(intArray, 4);</span>
<span class="nc" id="L236">            fail(&quot;Expecting IndexOutOfBoundsException&quot;);</span>
<span class="pc" id="L237">        } catch (final IndexOutOfBoundsException ex) {</span>
            // expected
        }

<span class="fc" id="L241">        iterator = IteratorUtils.arrayIterator(intArray, 2, 3);</span>
<span class="fc" id="L242">        assertTrue(iterator.next().equals(Integer.valueOf(2)));</span>

        try {
<span class="nc" id="L245">            iterator = IteratorUtils.arrayIterator(intArray, 2, 4);</span>
<span class="nc" id="L246">            fail(&quot;Expecting IndexOutOfBoundsException&quot;);</span>
<span class="pc" id="L247">        } catch (final IndexOutOfBoundsException ex) {</span>
            // expected
        }

        try {
<span class="nc" id="L252">            iterator = IteratorUtils.arrayIterator(intArray, -1, 1);</span>
<span class="nc" id="L253">            fail(&quot;Expecting IndexOutOfBoundsException&quot;);</span>
<span class="pc" id="L254">        } catch (final IndexOutOfBoundsException ex) {</span>
            // expected
        }

        try {
<span class="nc" id="L259">            iterator = IteratorUtils.arrayIterator(intArray, 2, 1);</span>
<span class="nc" id="L260">            fail(&quot;Expecting IllegalArgumentException&quot;);</span>
<span class="pc" id="L261">        } catch (final IllegalArgumentException ex) {</span>
            // expected
        }
<span class="fc" id="L264">    }</span>

    public void testArrayListIterator() {
<span class="fc" id="L267">        final Object[] objArray = {&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;};</span>
<span class="fc" id="L268">        ResettableListIterator&lt;Object&gt; iterator = IteratorUtils.arrayListIterator(objArray);</span>
<span class="pc bpc" id="L269" title="1 of 2 branches missed.">        assertTrue(!iterator.hasPrevious());</span>
<span class="pc bpc" id="L270" title="1 of 2 branches missed.">        assertTrue(iterator.previousIndex() == -1);</span>
<span class="pc bpc" id="L271" title="1 of 2 branches missed.">        assertTrue(iterator.nextIndex() == 0);</span>
<span class="fc" id="L272">        assertTrue(iterator.next().equals(&quot;a&quot;));</span>
<span class="fc" id="L273">        assertTrue(iterator.previous().equals(&quot;a&quot;));</span>
<span class="fc" id="L274">        assertTrue(iterator.next().equals(&quot;a&quot;));</span>
<span class="pc bpc" id="L275" title="1 of 2 branches missed.">        assertTrue(iterator.previousIndex() == 0);</span>
<span class="pc bpc" id="L276" title="1 of 2 branches missed.">        assertTrue(iterator.nextIndex() == 1);</span>
<span class="fc" id="L277">        assertTrue(iterator.next().equals(&quot;b&quot;));</span>
<span class="fc" id="L278">        assertTrue(iterator.next().equals(&quot;c&quot;));</span>
<span class="fc" id="L279">        assertTrue(iterator.next().equals(&quot;d&quot;));</span>
<span class="pc bpc" id="L280" title="1 of 2 branches missed.">        assertTrue(iterator.nextIndex() == 4); // size of list</span>
<span class="pc bpc" id="L281" title="1 of 2 branches missed.">        assertTrue(iterator.previousIndex() == 3);</span>

        try {
<span class="nc" id="L284">            iterator = IteratorUtils.arrayListIterator(Integer.valueOf(0));</span>
<span class="nc" id="L285">            fail(&quot;Expecting IllegalArgumentException&quot;);</span>
<span class="pc" id="L286">        } catch (final IllegalArgumentException ex) {</span>
                // expected
        }

        try {
<span class="nc" id="L291">            iterator = IteratorUtils.arrayListIterator((Object[]) null);</span>
<span class="nc" id="L292">            fail(&quot;Expecting NullPointerException&quot;);</span>
<span class="pc" id="L293">        } catch (final NullPointerException ex) {</span>
                // expected
        }

<span class="fc" id="L297">        iterator = IteratorUtils.arrayListIterator(objArray, 1);</span>
<span class="pc bpc" id="L298" title="1 of 2 branches missed.">        assertTrue(iterator.previousIndex() == -1);</span>
<span class="pc bpc" id="L299" title="1 of 2 branches missed.">        assertTrue(!iterator.hasPrevious());</span>
<span class="pc bpc" id="L300" title="1 of 2 branches missed.">        assertTrue(iterator.nextIndex() == 0);</span>
<span class="fc" id="L301">        assertTrue(iterator.next().equals(&quot;b&quot;));</span>
<span class="pc bpc" id="L302" title="1 of 2 branches missed.">        assertTrue(iterator.previousIndex() == 0);</span>

        try {
<span class="nc" id="L305">            iterator = IteratorUtils.arrayListIterator(objArray, -1);</span>
<span class="nc" id="L306">            fail(&quot;Expecting IndexOutOfBoundsException.&quot;);</span>
<span class="pc" id="L307">        } catch (final IndexOutOfBoundsException ex) {</span>
            // expected
        }

<span class="fc" id="L311">        iterator = IteratorUtils.arrayListIterator(objArray, 3);</span>
<span class="fc" id="L312">        assertTrue(iterator.hasNext());</span>
        try {
<span class="nc" id="L314">            iterator.previous();</span>
<span class="nc" id="L315">            fail(&quot;Expecting NoSuchElementException.&quot;);</span>
<span class="pc" id="L316">        } catch (final NoSuchElementException ex) {</span>
            // expected
        }

        try {
<span class="nc" id="L321">            iterator = IteratorUtils.arrayListIterator(objArray, 5);</span>
<span class="nc" id="L322">            fail(&quot;Expecting IndexOutOfBoundsException.&quot;);</span>
<span class="pc" id="L323">        } catch (final IndexOutOfBoundsException ex) {</span>
            // expected
        }

<span class="fc" id="L327">        iterator = IteratorUtils.arrayListIterator(objArray, 2, 3);</span>
<span class="fc" id="L328">        assertTrue(iterator.next().equals(&quot;c&quot;));</span>

        try {
<span class="nc" id="L331">            iterator = IteratorUtils.arrayListIterator(objArray, 2, 5);</span>
<span class="nc" id="L332">            fail(&quot;Expecting IndexOutOfBoundsException&quot;);</span>
<span class="pc" id="L333">        } catch (final IndexOutOfBoundsException ex) {</span>
            // expected
        }

        try {
<span class="nc" id="L338">            iterator = IteratorUtils.arrayListIterator(objArray, -1, 1);</span>
<span class="nc" id="L339">            fail(&quot;Expecting IndexOutOfBoundsException&quot;);</span>
<span class="pc" id="L340">        } catch (final IndexOutOfBoundsException ex) {</span>
            // expected
        }

        try {
<span class="nc" id="L345">            iterator = IteratorUtils.arrayListIterator(objArray, 2, 1);</span>
<span class="nc" id="L346">            fail(&quot;Expecting IllegalArgumentException&quot;);</span>
<span class="pc" id="L347">        } catch (final IllegalArgumentException ex) {</span>
            // expected
        }

<span class="fc" id="L351">        final int[] intArray = {0, 1, 2};</span>
<span class="fc" id="L352">        iterator = IteratorUtils.arrayListIterator(intArray);</span>
<span class="pc bpc" id="L353" title="1 of 2 branches missed.">        assertTrue(iterator.previousIndex() == -1);</span>
<span class="pc bpc" id="L354" title="1 of 2 branches missed.">        assertTrue(!iterator.hasPrevious());</span>
<span class="pc bpc" id="L355" title="1 of 2 branches missed.">        assertTrue(iterator.nextIndex() == 0);</span>
<span class="fc" id="L356">        assertTrue(iterator.next().equals(Integer.valueOf(0)));</span>
<span class="pc bpc" id="L357" title="1 of 2 branches missed.">        assertTrue(iterator.previousIndex() == 0);</span>
<span class="pc bpc" id="L358" title="1 of 2 branches missed.">        assertTrue(iterator.nextIndex() == 1);</span>
<span class="fc" id="L359">        assertTrue(iterator.next().equals(Integer.valueOf(1)));</span>
<span class="pc bpc" id="L360" title="1 of 2 branches missed.">        assertTrue(iterator.previousIndex() == 1);</span>
<span class="pc bpc" id="L361" title="1 of 2 branches missed.">        assertTrue(iterator.nextIndex() == 2);</span>
<span class="fc" id="L362">        assertTrue(iterator.previous().equals(Integer.valueOf(1)));</span>
<span class="fc" id="L363">        assertTrue(iterator.next().equals(Integer.valueOf(1)));</span>

<span class="fc" id="L365">        iterator = IteratorUtils.arrayListIterator(intArray, 1);</span>
<span class="pc bpc" id="L366" title="1 of 2 branches missed.">        assertTrue(iterator.previousIndex() == -1);</span>
<span class="pc bpc" id="L367" title="1 of 2 branches missed.">        assertTrue(!iterator.hasPrevious());</span>
<span class="pc bpc" id="L368" title="1 of 2 branches missed.">        assertTrue(iterator.nextIndex() == 0);</span>
<span class="fc" id="L369">        assertTrue(iterator.next().equals(Integer.valueOf(1)));</span>
<span class="fc" id="L370">        assertTrue(iterator.previous().equals(Integer.valueOf(1)));</span>
<span class="fc" id="L371">        assertTrue(iterator.next().equals(Integer.valueOf(1)));</span>
<span class="pc bpc" id="L372" title="1 of 2 branches missed.">        assertTrue(iterator.previousIndex() == 0);</span>
<span class="pc bpc" id="L373" title="1 of 2 branches missed.">        assertTrue(iterator.nextIndex() == 1);</span>
<span class="fc" id="L374">        assertTrue(iterator.next().equals(Integer.valueOf(2)));</span>
<span class="pc bpc" id="L375" title="1 of 2 branches missed.">        assertTrue(iterator.previousIndex() == 1);</span>
<span class="pc bpc" id="L376" title="1 of 2 branches missed.">        assertTrue(iterator.nextIndex() == 2);</span>
<span class="fc" id="L377">        assertTrue(iterator.previous().equals(Integer.valueOf(2)));</span>
<span class="pc bpc" id="L378" title="1 of 2 branches missed.">        assertTrue(iterator.previousIndex() == 0);</span>
<span class="pc bpc" id="L379" title="1 of 2 branches missed.">        assertTrue(iterator.nextIndex() == 1);</span>

        try {
<span class="nc" id="L382">            iterator = IteratorUtils.arrayListIterator(intArray, -1);</span>
<span class="nc" id="L383">            fail(&quot;Expecting IndexOutOfBoundsException&quot;);</span>
<span class="pc" id="L384">        } catch (final IndexOutOfBoundsException ex) {</span>
            // expected
        }

<span class="fc" id="L388">        iterator = IteratorUtils.arrayListIterator(intArray, 3);</span>
<span class="pc bpc" id="L389" title="1 of 2 branches missed.">        assertTrue(!iterator.hasNext());</span>

        try {
<span class="nc" id="L392">            iterator = IteratorUtils.arrayListIterator(intArray, 4);</span>
<span class="nc" id="L393">            fail(&quot;Expecting IndexOutOfBoundsException&quot;);</span>
<span class="pc" id="L394">        } catch (final IndexOutOfBoundsException ex) {</span>
            // expected
        }

<span class="fc" id="L398">        iterator = IteratorUtils.arrayListIterator(intArray, 2, 3);</span>
<span class="pc bpc" id="L399" title="1 of 2 branches missed.">        assertTrue(!iterator.hasPrevious());</span>
<span class="pc bpc" id="L400" title="1 of 2 branches missed.">        assertTrue(iterator.previousIndex() == -1);</span>
<span class="fc" id="L401">        assertTrue(iterator.next().equals(Integer.valueOf(2)));</span>
<span class="fc" id="L402">        assertTrue(iterator.hasPrevious());</span>
<span class="pc bpc" id="L403" title="1 of 2 branches missed.">        assertTrue(!iterator.hasNext());</span>


        try {
<span class="nc" id="L407">            iterator = IteratorUtils.arrayListIterator(intArray, 2, 4);</span>
<span class="nc" id="L408">            fail(&quot;Expecting IndexOutOfBoundsException&quot;);</span>
<span class="pc" id="L409">        } catch (final IndexOutOfBoundsException ex) {</span>
            // expected
        }

        try {
<span class="nc" id="L414">            iterator = IteratorUtils.arrayListIterator(intArray, -1, 1);</span>
<span class="nc" id="L415">            fail(&quot;Expecting IndexOutOfBoundsException&quot;);</span>
<span class="pc" id="L416">        } catch (final IndexOutOfBoundsException ex) {</span>
            // expected
        }

        try {
<span class="nc" id="L421">            iterator = IteratorUtils.arrayListIterator(intArray, 2, 1);</span>
<span class="nc" id="L422">            fail(&quot;Expecting IllegalArgumentException&quot;);</span>
<span class="pc" id="L423">        } catch (final IllegalArgumentException ex) {</span>
            // expected
        }
<span class="fc" id="L426">    }</span>


    /**
     * Gets an immutable Iterator operating on the elements [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;].
     */
    private Iterator&lt;String&gt; getImmutableIterator() {
<span class="fc" id="L433">        final List&lt;String&gt; list = new ArrayList&lt;String&gt;();</span>
<span class="fc" id="L434">        list.add(&quot;a&quot;);</span>
<span class="fc" id="L435">        list.add(&quot;b&quot;);</span>
<span class="fc" id="L436">        list.add(&quot;c&quot;);</span>
<span class="fc" id="L437">        list.add(&quot;d&quot;);</span>
<span class="fc" id="L438">        return IteratorUtils.unmodifiableIterator(list.iterator());</span>
    }

    /**
     * Gets an immutable ListIterator operating on the elements [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;].
     */
    private ListIterator&lt;String&gt; getImmutableListIterator() {
<span class="fc" id="L445">        final List&lt;String&gt; list = new ArrayList&lt;String&gt;();</span>
<span class="fc" id="L446">        list.add(&quot;a&quot;);</span>
<span class="fc" id="L447">        list.add(&quot;b&quot;);</span>
<span class="fc" id="L448">        list.add(&quot;c&quot;);</span>
<span class="fc" id="L449">        list.add(&quot;d&quot;);</span>
<span class="fc" id="L450">        return IteratorUtils.unmodifiableListIterator(list.listIterator());</span>
    }

    //-----------------------------------------------------------------------
    /**
     * Test empty iterator
     */
    public void testEmptyIterator() {
<span class="fc" id="L458">        assertSame(EmptyIterator.INSTANCE, IteratorUtils.EMPTY_ITERATOR);</span>
<span class="fc" id="L459">        assertSame(EmptyIterator.RESETTABLE_INSTANCE, IteratorUtils.EMPTY_ITERATOR);</span>
<span class="fc" id="L460">        assertEquals(true, IteratorUtils.EMPTY_ITERATOR instanceof Iterator);</span>
<span class="fc" id="L461">        assertEquals(true, IteratorUtils.EMPTY_ITERATOR instanceof ResettableIterator);</span>
<span class="fc" id="L462">        assertEquals(false, IteratorUtils.EMPTY_ITERATOR instanceof OrderedIterator);</span>
<span class="fc" id="L463">        assertEquals(false, IteratorUtils.EMPTY_ITERATOR instanceof ListIterator);</span>
<span class="fc" id="L464">        assertEquals(false, IteratorUtils.EMPTY_ITERATOR instanceof MapIterator);</span>
<span class="fc" id="L465">        assertEquals(false, IteratorUtils.EMPTY_ITERATOR.hasNext());</span>
<span class="fc" id="L466">        IteratorUtils.EMPTY_ITERATOR.reset();</span>
<span class="fc" id="L467">        assertSame(IteratorUtils.EMPTY_ITERATOR, IteratorUtils.EMPTY_ITERATOR);</span>
<span class="fc" id="L468">        assertSame(IteratorUtils.EMPTY_ITERATOR, IteratorUtils.emptyIterator());</span>
        try {
<span class="nc" id="L470">            IteratorUtils.EMPTY_ITERATOR.next();</span>
<span class="nc" id="L471">            fail();</span>
<span class="pc" id="L472">        } catch (final NoSuchElementException ex) {}</span>
        try {
<span class="nc" id="L474">            IteratorUtils.EMPTY_ITERATOR.remove();</span>
<span class="nc" id="L475">            fail();</span>
<span class="pc" id="L476">        } catch (final IllegalStateException ex) {}</span>
<span class="fc" id="L477">    }</span>

    //-----------------------------------------------------------------------
    /**
     * Test empty list iterator
     */
    public void testEmptyListIterator() {
<span class="fc" id="L484">        assertSame(EmptyListIterator.INSTANCE, IteratorUtils.EMPTY_LIST_ITERATOR);</span>
<span class="fc" id="L485">        assertSame(EmptyListIterator.RESETTABLE_INSTANCE, IteratorUtils.EMPTY_LIST_ITERATOR);</span>
<span class="fc" id="L486">        assertEquals(true, IteratorUtils.EMPTY_LIST_ITERATOR instanceof Iterator);</span>
<span class="fc" id="L487">        assertEquals(true, IteratorUtils.EMPTY_LIST_ITERATOR instanceof ListIterator);</span>
<span class="fc" id="L488">        assertEquals(true, IteratorUtils.EMPTY_LIST_ITERATOR instanceof ResettableIterator);</span>
<span class="fc" id="L489">        assertEquals(true, IteratorUtils.EMPTY_LIST_ITERATOR instanceof ResettableListIterator);</span>
<span class="fc" id="L490">        assertEquals(false, IteratorUtils.EMPTY_LIST_ITERATOR instanceof MapIterator);</span>
<span class="fc" id="L491">        assertEquals(false, IteratorUtils.EMPTY_LIST_ITERATOR.hasNext());</span>
<span class="fc" id="L492">        assertEquals(0, IteratorUtils.EMPTY_LIST_ITERATOR.nextIndex());</span>
<span class="fc" id="L493">        assertEquals(-1, IteratorUtils.EMPTY_LIST_ITERATOR.previousIndex());</span>
<span class="fc" id="L494">        IteratorUtils.EMPTY_LIST_ITERATOR.reset();</span>
<span class="fc" id="L495">        assertSame(IteratorUtils.EMPTY_LIST_ITERATOR, IteratorUtils.EMPTY_LIST_ITERATOR);</span>
<span class="fc" id="L496">        assertSame(IteratorUtils.EMPTY_LIST_ITERATOR, IteratorUtils.emptyListIterator());</span>
        try {
<span class="nc" id="L498">            IteratorUtils.EMPTY_LIST_ITERATOR.next();</span>
<span class="nc" id="L499">            fail();</span>
<span class="pc" id="L500">        } catch (final NoSuchElementException ex) {}</span>
        try {
<span class="nc" id="L502">            IteratorUtils.EMPTY_LIST_ITERATOR.previous();</span>
<span class="nc" id="L503">            fail();</span>
<span class="pc" id="L504">        } catch (final NoSuchElementException ex) {}</span>
        try {
<span class="nc" id="L506">            IteratorUtils.EMPTY_LIST_ITERATOR.remove();</span>
<span class="nc" id="L507">            fail();</span>
<span class="pc" id="L508">        } catch (final IllegalStateException ex) {}</span>
        try {
<span class="nc" id="L510">            IteratorUtils.emptyListIterator().set(null);</span>
<span class="nc" id="L511">            fail();</span>
<span class="pc" id="L512">        } catch (final IllegalStateException ex) {}</span>
        try {
<span class="nc" id="L514">            IteratorUtils.emptyListIterator().add(null);</span>
<span class="nc" id="L515">            fail();</span>
<span class="pc" id="L516">        } catch (final UnsupportedOperationException ex) {}</span>
<span class="fc" id="L517">    }</span>

    //-----------------------------------------------------------------------
    /**
     * Test empty map iterator
     */
    @SuppressWarnings(&quot;unchecked&quot;)
    public void testEmptyMapIterator() {
<span class="fc" id="L525">        assertSame(EmptyMapIterator.INSTANCE, IteratorUtils.EMPTY_MAP_ITERATOR);</span>
<span class="fc" id="L526">        assertEquals(true, IteratorUtils.EMPTY_MAP_ITERATOR instanceof Iterator);</span>
<span class="fc" id="L527">        assertEquals(true, IteratorUtils.EMPTY_MAP_ITERATOR instanceof MapIterator);</span>
<span class="fc" id="L528">        assertEquals(true, IteratorUtils.EMPTY_MAP_ITERATOR instanceof ResettableIterator);</span>
<span class="fc" id="L529">        assertEquals(false, IteratorUtils.EMPTY_MAP_ITERATOR instanceof ListIterator);</span>
<span class="fc" id="L530">        assertEquals(false, IteratorUtils.EMPTY_MAP_ITERATOR instanceof OrderedIterator);</span>
<span class="fc" id="L531">        assertEquals(false, IteratorUtils.EMPTY_MAP_ITERATOR instanceof OrderedMapIterator);</span>
<span class="fc" id="L532">        assertEquals(false, IteratorUtils.EMPTY_MAP_ITERATOR.hasNext());</span>
<span class="fc" id="L533">        ((ResettableIterator&lt;Object&gt;) IteratorUtils.EMPTY_MAP_ITERATOR).reset();</span>
<span class="fc" id="L534">        assertSame(IteratorUtils.EMPTY_MAP_ITERATOR, IteratorUtils.EMPTY_MAP_ITERATOR);</span>
<span class="fc" id="L535">        assertSame(IteratorUtils.EMPTY_MAP_ITERATOR, IteratorUtils.emptyMapIterator());</span>
        try {
<span class="nc" id="L537">            IteratorUtils.EMPTY_MAP_ITERATOR.next();</span>
<span class="nc" id="L538">            fail();</span>
<span class="pc" id="L539">        } catch (final NoSuchElementException ex) {}</span>
        try {
<span class="nc" id="L541">            IteratorUtils.EMPTY_MAP_ITERATOR.remove();</span>
<span class="nc" id="L542">            fail();</span>
<span class="pc" id="L543">        } catch (final IllegalStateException ex) {}</span>
        try {
<span class="nc" id="L545">            IteratorUtils.EMPTY_MAP_ITERATOR.getKey();</span>
<span class="nc" id="L546">            fail();</span>
<span class="pc" id="L547">        } catch (final IllegalStateException ex) {}</span>
        try {
<span class="nc" id="L549">            IteratorUtils.EMPTY_MAP_ITERATOR.getValue();</span>
<span class="nc" id="L550">            fail();</span>
<span class="pc" id="L551">        } catch (final IllegalStateException ex) {}</span>
        try {
<span class="nc" id="L553">            IteratorUtils.EMPTY_MAP_ITERATOR.setValue(null);</span>
<span class="nc" id="L554">            fail();</span>
<span class="pc" id="L555">        } catch (final IllegalStateException ex) {}</span>
<span class="fc" id="L556">    }</span>

    //-----------------------------------------------------------------------
    /**
     * Test empty map iterator
     */
    @SuppressWarnings(&quot;unchecked&quot;)
    public void testEmptyOrderedIterator() {
<span class="fc" id="L564">        assertSame(EmptyOrderedIterator.INSTANCE, IteratorUtils.EMPTY_ORDERED_ITERATOR);</span>
<span class="fc" id="L565">        assertEquals(true, IteratorUtils.EMPTY_ORDERED_ITERATOR instanceof Iterator);</span>
<span class="fc" id="L566">        assertEquals(true, IteratorUtils.EMPTY_ORDERED_ITERATOR instanceof OrderedIterator);</span>
<span class="fc" id="L567">        assertEquals(true, IteratorUtils.EMPTY_ORDERED_ITERATOR instanceof ResettableIterator);</span>
<span class="fc" id="L568">        assertEquals(false, IteratorUtils.EMPTY_ORDERED_ITERATOR instanceof ListIterator);</span>
<span class="fc" id="L569">        assertEquals(false, IteratorUtils.EMPTY_ORDERED_ITERATOR instanceof MapIterator);</span>
<span class="fc" id="L570">        assertEquals(false, IteratorUtils.EMPTY_ORDERED_ITERATOR.hasNext());</span>
<span class="fc" id="L571">        assertEquals(false, IteratorUtils.EMPTY_ORDERED_ITERATOR.hasPrevious());</span>
<span class="fc" id="L572">        ((ResettableIterator&lt;Object&gt;) IteratorUtils.EMPTY_ORDERED_ITERATOR).reset();</span>
<span class="fc" id="L573">        assertSame(IteratorUtils.EMPTY_ORDERED_ITERATOR, IteratorUtils.EMPTY_ORDERED_ITERATOR);</span>
<span class="fc" id="L574">        assertSame(IteratorUtils.EMPTY_ORDERED_ITERATOR, IteratorUtils.emptyOrderedIterator());</span>
        try {
<span class="nc" id="L576">            IteratorUtils.EMPTY_ORDERED_ITERATOR.next();</span>
<span class="nc" id="L577">            fail();</span>
<span class="pc" id="L578">        } catch (final NoSuchElementException ex) {}</span>
        try {
<span class="nc" id="L580">            IteratorUtils.EMPTY_ORDERED_ITERATOR.previous();</span>
<span class="nc" id="L581">            fail();</span>
<span class="pc" id="L582">        } catch (final NoSuchElementException ex) {}</span>
        try {
<span class="nc" id="L584">            IteratorUtils.EMPTY_ORDERED_ITERATOR.remove();</span>
<span class="nc" id="L585">            fail();</span>
<span class="pc" id="L586">        } catch (final IllegalStateException ex) {}</span>
<span class="fc" id="L587">    }</span>

    //-----------------------------------------------------------------------
    /**
     * Test empty map iterator
     */
    @SuppressWarnings(&quot;unchecked&quot;)
    public void testEmptyOrderedMapIterator() {
<span class="fc" id="L595">        assertSame(EmptyOrderedMapIterator.INSTANCE, IteratorUtils.EMPTY_ORDERED_MAP_ITERATOR);</span>
<span class="fc" id="L596">        assertEquals(true, IteratorUtils.EMPTY_ORDERED_MAP_ITERATOR instanceof Iterator);</span>
<span class="fc" id="L597">        assertEquals(true, IteratorUtils.EMPTY_ORDERED_MAP_ITERATOR instanceof MapIterator);</span>
<span class="fc" id="L598">        assertEquals(true, IteratorUtils.EMPTY_ORDERED_MAP_ITERATOR instanceof OrderedMapIterator);</span>
<span class="fc" id="L599">        assertEquals(true, IteratorUtils.EMPTY_ORDERED_MAP_ITERATOR instanceof ResettableIterator);</span>
<span class="fc" id="L600">        assertEquals(false, IteratorUtils.EMPTY_ORDERED_MAP_ITERATOR instanceof ListIterator);</span>
<span class="fc" id="L601">        assertEquals(false, IteratorUtils.EMPTY_ORDERED_MAP_ITERATOR.hasNext());</span>
<span class="fc" id="L602">        assertEquals(false, IteratorUtils.EMPTY_ORDERED_MAP_ITERATOR.hasPrevious());</span>
<span class="fc" id="L603">        ((ResettableIterator&lt;Object&gt;) IteratorUtils.EMPTY_ORDERED_MAP_ITERATOR).reset();</span>
<span class="fc" id="L604">        assertSame(IteratorUtils.EMPTY_ORDERED_MAP_ITERATOR, IteratorUtils.EMPTY_ORDERED_MAP_ITERATOR);</span>
<span class="fc" id="L605">        assertSame(IteratorUtils.EMPTY_ORDERED_MAP_ITERATOR, IteratorUtils.emptyOrderedMapIterator());</span>
        try {
<span class="nc" id="L607">            IteratorUtils.EMPTY_ORDERED_MAP_ITERATOR.next();</span>
<span class="nc" id="L608">            fail();</span>
<span class="pc" id="L609">        } catch (final NoSuchElementException ex) {}</span>
        try {
<span class="nc" id="L611">            IteratorUtils.EMPTY_ORDERED_MAP_ITERATOR.previous();</span>
<span class="nc" id="L612">            fail();</span>
<span class="pc" id="L613">        } catch (final NoSuchElementException ex) {}</span>
        try {
<span class="nc" id="L615">            IteratorUtils.EMPTY_ORDERED_MAP_ITERATOR.remove();</span>
<span class="nc" id="L616">            fail();</span>
<span class="pc" id="L617">        } catch (final IllegalStateException ex) {}</span>
        try {
<span class="nc" id="L619">            IteratorUtils.EMPTY_ORDERED_MAP_ITERATOR.getKey();</span>
<span class="nc" id="L620">            fail();</span>
<span class="pc" id="L621">        } catch (final IllegalStateException ex) {}</span>
        try {
<span class="nc" id="L623">            IteratorUtils.EMPTY_ORDERED_MAP_ITERATOR.getValue();</span>
<span class="nc" id="L624">            fail();</span>
<span class="pc" id="L625">        } catch (final IllegalStateException ex) {}</span>
        try {
<span class="nc" id="L627">            IteratorUtils.EMPTY_ORDERED_MAP_ITERATOR.setValue(null);</span>
<span class="nc" id="L628">            fail();</span>
<span class="pc" id="L629">        } catch (final IllegalStateException ex) {}</span>
<span class="fc" id="L630">    }</span>

    //-----------------------------------------------------------------------
    /**
     * Test next() and hasNext() for an immutable Iterator.
     */
    public void testUnmodifiableIteratorIteration() {
<span class="fc" id="L637">        final Iterator&lt;String&gt; iterator = getImmutableIterator();</span>

<span class="fc" id="L639">        assertTrue(iterator.hasNext());</span>

<span class="fc" id="L641">        assertEquals(&quot;a&quot;, iterator.next());</span>

<span class="fc" id="L643">        assertTrue(iterator.hasNext());</span>

<span class="fc" id="L645">        assertEquals(&quot;b&quot;, iterator.next());</span>

<span class="fc" id="L647">        assertTrue(iterator.hasNext());</span>

<span class="fc" id="L649">        assertEquals(&quot;c&quot;, iterator.next());</span>

<span class="fc" id="L651">        assertTrue(iterator.hasNext());</span>

<span class="fc" id="L653">        assertEquals(&quot;d&quot;, iterator.next());</span>

<span class="pc bpc" id="L655" title="1 of 2 branches missed.">        assertTrue(!iterator.hasNext());</span>
<span class="fc" id="L656">    }</span>

    /**
     * Test next(), hasNext(), previous() and hasPrevious() for an immutable
     * ListIterator.
     */
    public void testUnmodifiableListIteratorIteration() {
<span class="fc" id="L663">        final ListIterator&lt;String&gt; listIterator = getImmutableListIterator();</span>

<span class="pc bpc" id="L665" title="1 of 2 branches missed.">        assertTrue(!listIterator.hasPrevious());</span>
<span class="fc" id="L666">        assertTrue(listIterator.hasNext());</span>

<span class="fc" id="L668">        assertEquals(&quot;a&quot;, listIterator.next());</span>

<span class="fc" id="L670">        assertTrue(listIterator.hasPrevious());</span>
<span class="fc" id="L671">        assertTrue(listIterator.hasNext());</span>

<span class="fc" id="L673">        assertEquals(&quot;b&quot;, listIterator.next());</span>

<span class="fc" id="L675">        assertTrue(listIterator.hasPrevious());</span>
<span class="fc" id="L676">        assertTrue(listIterator.hasNext());</span>

<span class="fc" id="L678">        assertEquals(&quot;c&quot;, listIterator.next());</span>

<span class="fc" id="L680">        assertTrue(listIterator.hasPrevious());</span>
<span class="fc" id="L681">        assertTrue(listIterator.hasNext());</span>

<span class="fc" id="L683">        assertEquals(&quot;d&quot;, listIterator.next());</span>

<span class="fc" id="L685">        assertTrue(listIterator.hasPrevious());</span>
<span class="pc bpc" id="L686" title="1 of 2 branches missed.">        assertTrue(!listIterator.hasNext());</span>

<span class="fc" id="L688">        assertEquals(&quot;d&quot;, listIterator.previous());</span>

<span class="fc" id="L690">        assertTrue(listIterator.hasPrevious());</span>
<span class="fc" id="L691">        assertTrue(listIterator.hasNext());</span>

<span class="fc" id="L693">        assertEquals(&quot;c&quot;, listIterator.previous());</span>

<span class="fc" id="L695">        assertTrue(listIterator.hasPrevious());</span>
<span class="fc" id="L696">        assertTrue(listIterator.hasNext());</span>

<span class="fc" id="L698">        assertEquals(&quot;b&quot;, listIterator.previous());</span>

<span class="fc" id="L700">        assertTrue(listIterator.hasPrevious());</span>
<span class="fc" id="L701">        assertTrue(listIterator.hasNext());</span>

<span class="fc" id="L703">        assertEquals(&quot;a&quot;, listIterator.previous());</span>

<span class="pc bpc" id="L705" title="1 of 2 branches missed.">        assertTrue(!listIterator.hasPrevious());</span>
<span class="fc" id="L706">        assertTrue(listIterator.hasNext());</span>
<span class="fc" id="L707">    }</span>

    /**
     * Test remove() for an immutable Iterator.
     */
    public void testUnmodifiableIteratorImmutability() {
<span class="fc" id="L713">        final Iterator&lt;String&gt; iterator = getImmutableIterator();</span>

        try {
<span class="nc" id="L716">            iterator.remove();</span>
            // We shouldn't get to here.
<span class="nc" id="L718">            fail(&quot;remove() should throw an UnsupportedOperationException&quot;);</span>
<span class="pc" id="L719">        } catch (final UnsupportedOperationException e) {</span>
            // This is correct; ignore the exception.
        }

<span class="fc" id="L723">        iterator.next();</span>

        try {
<span class="nc" id="L726">            iterator.remove();</span>
            // We shouldn't get to here.
<span class="nc" id="L728">            fail(&quot;remove() should throw an UnsupportedOperationException&quot;);</span>
<span class="pc" id="L729">        } catch (final UnsupportedOperationException e) {</span>
            // This is correct; ignore the exception.
        }

<span class="fc" id="L733">    }</span>

    /**
     * Test remove() for an immutable ListIterator.
     */
    public void testUnmodifiableListIteratorImmutability() {
<span class="fc" id="L739">        final ListIterator&lt;String&gt; listIterator = getImmutableListIterator();</span>

        try {
<span class="nc" id="L742">            listIterator.remove();</span>
            // We shouldn't get to here.
<span class="nc" id="L744">            fail(&quot;remove() should throw an UnsupportedOperationException&quot;);</span>
<span class="pc" id="L745">        } catch (final UnsupportedOperationException e) {</span>
            // This is correct; ignore the exception.
        }

        try {
<span class="nc" id="L750">            listIterator.set(&quot;a&quot;);</span>
            // We shouldn't get to here.
<span class="nc" id="L752">            fail(&quot;set(Object) should throw an UnsupportedOperationException&quot;);</span>
<span class="pc" id="L753">        } catch (final UnsupportedOperationException e) {</span>
            // This is correct; ignore the exception.
        }

        try {
<span class="nc" id="L758">            listIterator.add(&quot;a&quot;);</span>
            // We shouldn't get to here.
<span class="nc" id="L760">            fail(&quot;add(Object) should throw an UnsupportedOperationException&quot;);</span>
<span class="pc" id="L761">        } catch (final UnsupportedOperationException e) {</span>
            // This is correct; ignore the exception.
        }

<span class="fc" id="L765">        listIterator.next();</span>

        try {
<span class="nc" id="L768">            listIterator.remove();</span>
            // We shouldn't get to here.
<span class="nc" id="L770">            fail(&quot;remove() should throw an UnsupportedOperationException&quot;);</span>
<span class="pc" id="L771">        } catch (final UnsupportedOperationException e) {</span>
            // This is correct; ignore the exception.
        }

        try {
<span class="nc" id="L776">            listIterator.set(&quot;a&quot;);</span>
            // We shouldn't get to here.
<span class="nc" id="L778">            fail(&quot;set(Object) should throw an UnsupportedOperationException&quot;);</span>
<span class="pc" id="L779">        } catch (final UnsupportedOperationException e) {</span>
            // This is correct; ignore the exception.
        }

        try {
<span class="nc" id="L784">            listIterator.add(&quot;a&quot;);</span>
            // We shouldn't get to here.
<span class="nc" id="L786">            fail(&quot;add(Object) should throw an UnsupportedOperationException&quot;);</span>
<span class="pc" id="L787">        } catch (final UnsupportedOperationException e) {</span>
            // This is correct; ignore the exception.
        }
<span class="fc" id="L790">    }</span>

    /**
     * Tests method nodeListIterator(NodeList)
     */
    public void testNodeListIterator() {
<span class="fc" id="L796">        final Node[] nodes = createNodes();</span>
<span class="fc" id="L797">        final NodeList nodeList = createNodeList(nodes);</span>

<span class="fc" id="L799">        final Iterator&lt;Node&gt; iterator = IteratorUtils.nodeListIterator(nodeList);</span>
<span class="fc" id="L800">        int expectedNodeIndex = 0;</span>
<span class="fc bfc" id="L801" title="All 2 branches covered.">        for (final Node actual : IteratorUtils.asIterable(iterator)) {</span>
<span class="fc" id="L802">            assertEquals(nodes[expectedNodeIndex], actual);</span>
<span class="fc" id="L803">            ++expectedNodeIndex;</span>
        }

        // insure iteration occurred
<span class="pc bpc" id="L807" title="1 of 2 branches missed.">        assertTrue(expectedNodeIndex &gt; 0);</span>

        // single use iterator
<span class="fc" id="L810">        assertFalse(&quot;should not be able to iterate twice&quot;, IteratorUtils.asIterable(iterator).iterator().hasNext());</span>
<span class="fc" id="L811">    }</span>
    /**
     * Tests method nodeListIterator(Node)
     */
    public void testNodeIterator() {
<span class="fc" id="L816">        final Node[] nodes = createNodes();</span>
<span class="fc" id="L817">        final NodeList nodeList = createNodeList(nodes);</span>
<span class="fc" id="L818">        final Node parentNode = createMock(Node.class);</span>
<span class="fc" id="L819">        expect(parentNode.getChildNodes()).andStubReturn(nodeList);</span>
<span class="fc" id="L820">        replay(parentNode);</span>

<span class="fc" id="L822">        final Iterator&lt;Node&gt; iterator = IteratorUtils.nodeListIterator(parentNode);</span>
<span class="fc" id="L823">        int expectedNodeIndex = 0;</span>
<span class="fc bfc" id="L824" title="All 2 branches covered.">        for (final Node actual : IteratorUtils.asIterable(iterator)) {</span>
<span class="fc" id="L825">            assertEquals(nodes[expectedNodeIndex], actual);</span>
<span class="fc" id="L826">            ++expectedNodeIndex;</span>
        }

        // insure iteration occurred
<span class="pc bpc" id="L830" title="1 of 2 branches missed.">        assertTrue(expectedNodeIndex &gt; 0);</span>

        // single use iterator
<span class="fc" id="L833">        assertFalse(&quot;should not be able to iterate twice&quot;, IteratorUtils.asIterable(iterator).iterator().hasNext());</span>
<span class="fc" id="L834">    }</span>

    /**
     * creates an array of four Node instances, mocked by EasyMock.
     */
    private Node[] createNodes() {
<span class="fc" id="L840">        final Node node1 = createMock(Node.class);</span>
<span class="fc" id="L841">        final Node node2 = createMock(Node.class);</span>
<span class="fc" id="L842">        final Node node3 = createMock(Node.class);</span>
<span class="fc" id="L843">        final Node node4 = createMock(Node.class);</span>
<span class="fc" id="L844">        replay(node1);</span>
<span class="fc" id="L845">        replay(node2);</span>
<span class="fc" id="L846">        replay(node3);</span>
<span class="fc" id="L847">        replay(node4);</span>

<span class="fc" id="L849">        return new Node[]{node1, node2, node3, node4};</span>
}

    /**
     * Creates a NodeList containing the specified nodes.
     */
    private NodeList createNodeList(final Node[] nodes) {
<span class="fc" id="L856">        return new NodeList() {</span>
            public Node item(final int index) {
<span class="fc" id="L858">                return nodes[index];</span>
            }
            public int getLength() {
<span class="fc" id="L861">                return nodes.length;</span>
            }
        };
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.1.201803210924</span>commons-collections-collections-4.0 (25-Jun-2019 5:27:32 PM)</div></body></html>